;================================ EXTENSIONS.CONF ==================================
; Dialplan para testes SIPX com políticas diferentes de OPTIONS

[general]
static=yes
writeprotect=no
clearglobalvars=no

[globals]

[sipx-test]
; ============================================================================
; Echo test - testa áudio
; ============================================================================
exten => 100,1,NoOp(Echo Test)
same => n,Answer()
same => n,Wait(1)
same => n,Playback(demo-echotest)
same => n,Echo()
same => n,Hangup()

; ============================================================================
; Music on Hold
; ============================================================================
exten => 200,1,NoOp(Music on Hold Test)
same => n,Answer()
same => n,MusicOnHold()

; ============================================================================
; Voicemail test
; ============================================================================
exten => 300,1,NoOp(Voicemail Test)
same => n,Answer()
same => n,Playback(vm-intro)
same => n,Hangup()

; ============================================================================
; Time announcement
; ============================================================================
exten => 400,1,NoOp(Time Test)
same => n,Answer()
same => n,SayUnixTime()
same => n,Hangup()

; ============================================================================
; Conference room
; ============================================================================
exten => 500,1,NoOp(Conference Room)
same => n,Answer()
same => n,ConfBridge(1)
same => n,Hangup()

; ============================================================================
; Chamadas entre extensões (1111, 2222, 3333)
; ============================================================================
exten => 1111,1,NoOp(Calling ${EXTEN})
same => n,Dial(PJSIP/${EXTEN},30,rtT)
same => n,Hangup()

exten => 2222,1,NoOp(Calling ${EXTEN})
same => n,Dial(PJSIP/${EXTEN},30,rtT)
same => n,Hangup()

exten => 3333,1,NoOp(Calling ${EXTEN})
same => n,Dial(PJSIP/${EXTEN},30,rtT)
same => n,Hangup()

; ============================================================================
; Fallback para outras extensões
; ============================================================================
exten => _[1-9]XXX,1,NoOp(Calling ${EXTEN})
same => n,Dial(PJSIP/${EXTEN},30,rtT)
same => n,Hangup()

; ============================================================================
; Tratamento de registro (s extension)
; ============================================================================
exten => s,1,NoOp(Incoming Request)
same => n,Hangup()

; ============================================================================
; Tratamento especial de OPTIONS para endpoint 3333
; OPTIONS não é normalmente tratado no dialplan, mas podemos usar
; o evento de pre-dial para rejeitar. Como OPTIONS não passa pelo dialplan
; normal, a rejeição será feita via pjsip.conf (sem auth = 401)
; ============================================================================
